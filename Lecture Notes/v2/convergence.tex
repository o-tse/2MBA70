  

\section{Convergence of integrals}

One of the motivations for developing a new theory of integration using measurable functions instead of continuous ones was that we would be able to change limits and integrals more often. We have already seen an example of such a result in the monotone convergence theorem, Theorem~\ref{th:monotone-convergence-I}. However, this required that the sequence $f_n$ of functions was monotone (i.e. non-decreasing) everywhere, which sounds a bit restrictive. That is why in this section we will use the monotone convergence theorem to derive other convergence results with less restrictive conditions.

\subsection{Monotone convergence (continued)}

Theorem~\ref{th:monotone-convergence-I} states that if we have a sequence of measurable functions $(f_n)_{n \in \bbN}$ from some measure space $(\Omega, \cF, \mu)$ to $[0,+\infty]$ such that $f_n \le f_{n+1}$, then we could interchange limits and integration so that
\[
	\lim_{n \to \infty} \int_\Omega f_n \, \dd \mu = \int_\Omega \lim_{n \to \infty} f_n \, \dd \mu.
\]
It should be noted that the monotone properties requires that $f_n(\omega) \le f_{n+1}(\omega)$ for all $\omega \in \Omega$. However, from the definition of the Lebesgue integral we see that it is not affected by sets measure zero. Hence, we would expect that we can relax the monotone property to hold $\mu$-almost everywhere, i.e. the set where it does not hold has measure zero. This turns out to be the case, providing a slightly more general version of the monotone convergence theorem.

\begin{theorem}[Monotone convergence II]\label{thm:monotone_convergence_ii}
Let $(\Omega, \cF, \mu)$ be a measure space. Let $(f_n)_{n \ge 1}$ be a sequence of non-negative, measurable functions and let $f$ be a non-negative measurable functions such that the following holds $\mu$-almost everywhere
\begin{enumerate}[label={(\arabic*)}]
	\item $f_n \le f_{n+1}$ for all $n \in \bbN$, and
	\item $\lim_{n \to \infty} f_n = f$.
\end{enumerate}
Then
\[
	\lim_{n \to \infty} \int_\Omega f_n \,\dd \mu = \int_\Omega f \,\dd \mu.
\]
\end{theorem}

\begin{proof}
As you might have expected, the proof will use the first monotone convergence theorem. For this we first note that by assumption there exists a $N \in \cF$ with $\mu(N) = 0$ such that properties 1 and 2 from theorem statement hold for all $\omega \in \Omega \backslash N$. Now define the function $g_n(\omega) = \max_{1 \le k \le n} f_k(\omega)$. Then $g_n(\omega) \le g_{n+1}(\omega)$ holds for \emph{all} $\omega \in \Omega$. We further define $g(\omega) := \lim_{n \to \infty} g_n(\omega)$. Here comes the key observation. For every $\omega \in \Omega\backslash N$ it holds that $g_n(\omega) = f_n(\omega)$ and $g(\omega) = f(\omega)$. Moreover, since $\mu(N) = 0$ we have that
\[
	\int_\Omega f_n \, \dd \mu = \int_\Omega g_n \, \dd \mu \qquad \text{and} \qquad
	\int_\Omega f \, \dd \mu = \int_\Omega g \, \dd \mu.
\]
The result then follows by applying Theorem~\ref{th:monotone-convergence-I} to the functions $g_n$ and $g$.
\end{proof}

\subsection{Fatou's Lemma}

\begin{theorem}[Fatou's lemma]\label{thm:fatou}
Let $(\Omega, \cF, \mu)$ be a measure space. Let $(f_n)_{n \ge 1}$ be a sequence of non-negative, measurable functions and define
\[
	f := \liminf_{n\to \infty} f_n = \lim_{n \to \infty} \inf_{k \ge n} f_k.
\]
Then
\[
	\int_\Omega f\, \dd \mu \le \liminf_{n\to \infty} \int_\Omega f_n \,\dd \mu.
\]
\end{theorem}

\begin{proof}
Our proof will use the monotone convergence theorem. There are however other proofs, based on first principles. 

Define the function $g_n(\omega) := \inf_{k \ge n} f_k(\omega)$ and note that by Lemma~\ref{lem:limit_operations_measurable_functions} $g_n$ are measurable. Moreover, $g_n(\omega) \le g_{n+1}(\omega)$ for all $\omega \in \Omega$ and $\lim_{n \to \infty} g_n(\omega) = f(\omega)$. Hence, Theorem~\ref{thm:monotone_convergence_ii} implies that
\[
	\lim_{n \to \infty} \int_\Omega g_n \, \dd \mu = \int_\Omega \lim_{n \to \infty} g_n \, \dd \mu
	= \int f \, \dd \mu. 
\]
Finally we observe that by definition $g_n \le f_n$ holds for all $n \in \bbN$ so that
\begin{align*}
	\int f \, \dd \mu = \lim_{n \to \infty} \int_\Omega g_n \, \dd \mu
	&= \lim_{n \to \infty} \int_\Omega \inf_{k \ge n} f_k \, \dd \mu \\
	&\le \lim_{n \to \infty} \inf_{\ell \ge n} \int_\Omega  f_\ell \, \dd \mu
	= \liminf_{n \to \infty} \int_\Omega  f_\ell \, \dd \mu.
\end{align*}
Here, we used that $\inf_{k \ge n} f_k \le f_\ell$ for all $\ell \ge n$ and the monotonicity property of the integral (see Proposition~\ref{prop:properties-integral}).
\end{proof}

\subsection{Dominated Convergence}

Armed with Fatou's lemma we can now prove one of the most useful convergence results for Lebesgue integrals.

\begin{theorem}[Dominated convergence]\label{thm:dominated_convergence}
Let $(\Omega, \cF, \mu)$ be a measure space. Let $(f_n)_{n \ge 1}$ be a sequence of measurable functions and let $f$ be a measurable function such that $\lim_{n\to\infty}f_n = f$ $\mu$-almost everywhere. Moreover, assume there exists a non-negative $\mu$-integrable function $g : \Omega \to [0,\infty]$ such that $|f_n| \le g$ $\mu$-almost everywhere. Then
\[
	\lim_{n \to \infty} \int_\Omega f_n \,\dd \mu = \int_\Omega f \,\dd \mu.
\]
\end{theorem}

\begin{proof}
We will first prove the result for the case that both $|f_n| \le g$ and $\lim_{n\to\infty} f_n =f$ hold everywhere.  

Consider the functions $f_n+g$ and note that $|f_n| \le g$ implies that these are non-negative. Fatou's lemma (Theorem~\ref{thm:fatou}) now implies that
\[
	\int_\Omega f + g \, \dd \mu \le \liminf_{n \to \infty} \int_\Omega f_n + g \, \dd \mu.
\] 
Using the additive property of the integral we get
\[
	\int_\Omega f \, \dd \mu + \int_\Omega g \, \dd \mu 
	\le \liminf_{n \to \infty} \int_\Omega f_n \, \dd \mu + \int_\Omega g \, \dd \mu.
\]
Since $\int_\Omega g \, \dd \mu < \infty$ this implies that
\[
	\int_\Omega f \, \dd \mu \le \liminf_{n \to \infty} \int_\Omega f_n \, \dd \mu.
\]
On the other hand, the condition $|f_n| \le g$ also implies that the functions $g - f_n$ are non-negative. Applying Fatou's lemma here yields
\[
	\int_\Omega g - f \, \dd \mu \le \liminf_{n \to \infty} \int_\Omega g - f_n \, \dd \mu.
\]
The additive property of integral now yields
\[
	\int_\Omega g \dd \mu - \int_\Omega f \, \dd \mu \le \int_\Omega g \, \dd \mu 
	+ \liminf_{n \to \infty} \int_\Omega - f_n \, \dd \mu,
\]
which implies that 
\[
	\int_\Omega f \, \dd \mu \ge - \liminf_{n \to \infty} \int_\Omega - f_n \, \dd \mu 
	= \limsup_{n \to \infty} \int_\Omega f_n \, \dd \mu.
\]
We thus conclude that
\[
	\lim_{n \to \infty} \int_\Omega f_n \, \dd \mu = \int_\Omega f \, \dd \mu.
\]

Now let us consider the general case. Then there exists a $N \in \cF$ such that $\mu(N) = 0$ and both $|f_n| \le g$ and $f_n \to f$ hold for every $\omega \in \Omega \backslash N$. Let us now define the following functions
\[
	\hat{f}_n(\omega) = \begin{cases}
		f_n(\omega) &\text{if } \omega \in \Omega \backslash N,\\
		0 &\text{else,}
	\end{cases}
	\quad 
	\hat{f}(\omega) = \begin{cases}
		f(\omega) &\text{if } \omega \in \Omega \backslash N,\\
		0 &\text{else,}
	\end{cases}
\]
and
\[
	\hat{g}(\omega) = \begin{cases}
		g(\omega) &\text{if } \omega \in \Omega \backslash N,\\
		0 &\text{else.}
	\end{cases}
\]

Then 
\[
	\int_\Omega \hat{f}_n \, \dd \mu = \int_\Omega f_n \, \dd \mu \quad \text{and} \quad
	\int_\Omega \hat{f} \, \dd \mu = \int_\Omega f \, \dd \mu
\]
Moreover, $\hat{f}_n \le \hat{g}$ and $\hat{f}_n \to \hat{f}$ hold \emph{everywhere}. So using the first part of the proof we have that
\[
	\lim_{n \to \infty} \int_\Omega f_n \, \dd \mu = \lim_{n \to \infty} \int_\Omega \hat{f}_n \, \dd \mu
	= \lim_{n \to \infty} \int_\Omega \hat{f} \, \dd \mu = \lim_{n \to \infty} \int_\Omega f \, \dd \mu.\qedhere
\]
\end{proof}

\begin{example}
Consider the sequence of functions $f_n(x) = \frac{n \sin(x/n)}{x(x^2+1)}$. We will use dominated convergence to determine $\lim_{n \to \infty} \int_\bbR f_n \, \dd \lambda$. Define $g(x) = \frac{1}{x^2 +1}$ and note that 
\[
	f_n(x) = \frac{\sin(x/n)}{x/n} g(x).
\]
Note that $|\sin(y)| \le |y|$ holds for all $y > 0$ and that for every $x$ we have that $\lim_{n \to \infty} \frac{\sin(x/n)}{x/n} = 1$. We thus conclude that $|f_n(x)| \le g(x)$ and $f_n \to g(x)$ holds for all $x \in \bbR \backslash \{0\}$. Since the set $\{0\}$ has Lebesgue measure zero, all the conditions of Theorem~\ref{thm:dominated_convergence} are satisfied. Hence (see Example~\ref{ex:computation_lebesgue_integral})
\[
	\lim_{n \to \infty} \int_\bbR \frac{n \sin(x/n)}{x(x^2+1)} \lambda(\dd x) 
	= \int_\bbR \frac{1}{x^2 +1} \lambda(\dd x) = \pi.
\]
\end{example}

\section{Convergence of finite measures}\label{sec:weak_convergence_finite_measures}

Until now we have been mainly concerned with convergence of integrals for a sequence of functions $(f_n)_{n \ge 1}$ and fixed measure $\mu$. But what if instead we have a sequence of measures $(\mu_n)_{n \ge 1}$ on a given measurable space. When does this sequence convergence to a limit measure $\mu$? And what does that actually mean?

These are the questions we will address in this section. To properly address them we need to restrict ourselves to finite measures, and thus we will without loss of generality consider probability measures. Moreover, while the concepts we will introduce can be generalized to any topological space with the corresponding Borel \sigalg/, for the sake of clarity we will restrict our attention to $(\bbR, \cB_\bbR)$. 

We start by defining what convergence of probability measures means. We will use $C_b(\bbR)$ to denote the class of continuous bounded functions on $\bbR$.

\begin{definition}
Let $(\mu_n)_{n \ge 1}$ and $\mu$ be probability measures on $(\bbR, \cB_\bbR)$. We say that $\mu_n$ \emph{converges weakly} (or \emph{narrowly}) to $\mu$ if for every continuous bounded function $h\in C_b(\bbR)$ it holds that
\[
	\int_\bbR h \, \dd \mu_n \to \int_\bbR h \, \dd \mu.
\]
If this is the case we write $\mu_n \Rightarrow \mu$.
\end{definition}

The definition of weak convergence asks us to verify the convergence of the $\mu_n$ integral of $h$ for any $h\in C_b(\bbR)$. In some cases that can be a cumbersome task. Hence it would be helpful if we would have some equivalent conditions for weak convergence. The beauty here is that there are many equivalent definitions. They are often summarized in what is known as the Portmanteau theorem (or lemma). We provide one version of it below.

%We will first prove an important technical lemma, needed for the proof of this theorem. For any function $h\colon \bbR \to \bbR$ we denote by $\cC_h \subset \bbR$ the set of continuity points of $h$, i.e. the set of all points $x\in \bbR$ at which $h$ is continuous. 

%\medskip
%
%We first mention an important technical lemma needed for the proof of this theorem. For any function $h\colon \bbR \to \bbR$, we denote by $\cC_h \subset \bbR$ the set of continuity points of $h$, i.e., the set of all points $x\in \bbR$ at which $h$ is continuous. The following technical lemma, which can be deduced from Lusin's theorem (cf.~Theorem~\ref{thm:lusin}), allows us to approximate measurable functions by continuous ones, with arbitrary precision in terms of the integrals. 
%
%\begin{lemma}
%Consider a probability measure $\mu$ on $(\bbR, \cB_\bbR)$ and bounded measurable function $h\in B_b(\bbR)$ with $\mu(\cC_h) = 1$. Then for every $\varepsilon > 0$, there exist continuous bounded functions $h^-_\varepsilon$ and $h^+_\varepsilon$ such that
%\begin{enumerate}[label={(\arabic*)}]
%\item $h^-_\varepsilon \le h \le h^+_\varepsilon$ and
%\item $\int_\bbR h^+_\varepsilon \, \dd \mu - \int_\bbR h^-_\varepsilon \, \dd \mu < \varepsilon$.
%\end{enumerate} 
%\end{lemma}
%\begin{proof}
%For $k \in \bbN$ define the functions
%\[
%	g_k := \inf_{y \in \bbR} h(y) + k\|x-y\| \quad G_k := \sup_{y \in \bbR} h(y) - k\|x-y\|.
%\]
%We then observe that for any $k \in \bbN$, $g_k \le g_{k + 1}$, $G_{k+1} \le G_k$ and $g_k \le h \le G_k$. Hence
%\[
%	g_1 \le g_2 \le \dots \le h \le \dots \le G_2 \le G_1.
%\]
%Moreover, since for any fixed $x \in \bbR$ the sequences $(g_k(x))_{k \ge 1}$ and $(G_k(x))_{k \ge 1}$ are bounded we get that their limits as $k \to \infty$ exist and
%\[
%	\lim_{k \to \infty} g_k(x) \le h(x) \le \lim_{k \to \infty} G_k(x).
%\]
%
%We now claim that for every $k \ge 1$ the functions $g_k$ and $M_k$ are continuous and bounded. The last part follows from directly from the definitions. For the continuity we note that
%\begin{align*}
%	g_k(x) = \inf_{y \in \bbR} h(y) + k \|x-y\|
%	\le \inf_{y \in \bbR} h(y) + k \|z-y\| +k \|x-z\|
%	= g_k(z) + k\|x-z\|,
%\end{align*}
%which implies that $\|g_k(x) - g_k(y)\| \le k \|x-y\|$. A similar argument works for $G_k$.
%
%Now, let $x \in \cC_h$, i.e. $x$ is a continuity point of $h$, and fix $\varepsilon > 0$. Then there exist a $\delta > 0$ such that $\|x-y\| < \delta$ implies that $\|h(x) - h(y)\| < \varepsilon$. If we then define
%\[
%	r =  \left \lceil \frac{h(x) - \inf_{z \in \bbR} h(z)}{\delta} \right \rceil,
%\]
%then
%\begin{align*}
%	\lim_{k \to \infty} g_k(x) &\ge g_r(x)\\
%	&= \min\{ \inf_{\|x-y\| \ge \delta} h(y) + r\|x-y\| + \inf_{\|x-y\| < \delta} h(y) + r\|x-y\|\}\\
%	&\ge \min\{h(x) - \varepsilon, \, \inf_{z \in \bbR} h(z) + (h(x) - \inf_{z \in \bbR} h(z))\delta/\delta\} \\
%	&= h(x) - \varepsilon.
%\end{align*}
%Similarly, we get that $\lim_{k \to \infty} G_K(x) \le h(x) + \varepsilon$. Since $\mu(\cC_h) = 1$ this then implies that
%\[
%	\int_\bbR \lim_{k \to \infty} g_k \, \dd \mu  = \int_\bbR h \, \dd \mu 
%	= \int_\bbR \lim_{k \to \infty} G_k \, \dd \mu. 
%\]
%
%Applying Theorem~\ref{thm:monotone_convergence_ii} to $g_k$ and to $-G_k$ we get that
%\[
%	\lim_{k \to \infty} \int_\bbR g_k \, \dd \mu = \int_\bbR h \, \dd \mu
%	= \lim_{k \to \infty} \int_\bbR G_k \, \dd \mu.
%\]
%Finally, since $g_k$ is non-decreasing and $G_k$ is non-increasing, for every $\varepsilon$ there must exist an $K$ such that for all $k \ge K$
%\[
%	\int_\bbR (G_k - g_k) \, \dd \mu = \int_\bbR (G_k - h) \, \dd \mu + \int_\bbR (h - g_k) \, \dd \mu \le \varepsilon. 
%\]
%So we can take
%\[
%	h^-_\varepsilon := g_K \quad \text{and} \quad h^+_\varepsilon := G_K.\qedhere
%\]
%\end{proof}

%Recall that a set $A \subset \bbR^d$ is open if for every $x \in A$ there exists an $r > 0$ such that $B_x(r) \subset A$. In addition, a set $B\subset \bbR^d$ is called \emph{closed} if $B = \bbR^d \backslash A$ for some open set $A$.

For a set $A \subset \bbR$ denote by $\bar{A}$ the smallest closed set that contains $A$ and by $A^\circ$ the largest open set that is contained in $A$. The sets $\bar{A}$ and $A^\circ$ are called the \emph{closure} and \emph{interior} of $A$, respectively. We now define the \emph{boundary} of $A$ as $\partial A := \bar{A} \backslash A^\circ$. Given a measure $\mu$ on $(\bbR, \cB_\bbR)$, a set $A$ is called a \emph{$\mu$-continuity set} if $\mu(\partial A) = 0$.

\begin{definition}[$\mu$-continuity set]
	Let $A\in\cB_\bbR$. Given a measure $\mu$ on $(\bbR, \cB_\bbR)$, a set $A$ is called a \emph{$\mu$-continuity set} if $\mu(\partial A) = 0$.
\end{definition}

We can now state a list of equivalent definitions for weak convergence of probability measures.

\begin{theorem}[Portmanteau Theorem]\label{thm:portmanteau}
Let $(\mu_n)_{n \ge 1}$ and $\mu$ be probability measures on $(\bbR, \cB_\bbR)$. Then the following statements are equivalent:
\begin{enumerate}[label={(\arabic*)}]
\item $\mu_n \Rightarrow \mu$.
\item $\int_\bbR h \, \dd \mu_n \to \int_\bbR h \, \dd \mu$ for all bounded measurable functions $h$ with $\mu(\cC_h) = 1$.
\item $\int_\bbR g \, \dd \mu_n \to \int_\bbR g \, \dd \mu$ for all continuous functions $g$ with compact support, i.e., functions $g\in C_b(\bbR)$ that are zero outside an interval $[-K,K]$ for some $K > 0$.
\item $\limsup_{n \to \infty} \mu_n(B) \le \mu(B)$ for all closed sets $B \subset \bbR$.
\item $\liminf_{n \to \infty} \mu_n(A) \ge \mu(A)$ for all open sets $A \subset \bbR$.
\item $\lim_{n \to \infty} \mu(C) = \mu(C)$ for all $\mu$-continuity sets $C$.
\end{enumerate}
\end{theorem} 

\begin{proof}
The proof of this theorem is mostly technical and for the most part does not provide any interesting insights. The implication \textbf{1} $\iff$ \textbf{3} is dealt with in Problem~\ref{prb:portmanteau}. For the full proof we refer to Appendix~\ref{chapter:appendix-portmanteau}. 
\end{proof}

\section{Problems}

\begin{problem}\label{prb:reverse_fatou}
Prove the reverse Fatou lemma:

\smallskip
\textit{
Let $(\Omega, \cF, \mu)$ be a measure space. Let $(f_n)_{n \ge 1}$ and $f$ be non-negative, measurable functions such that $f_n \le f$ and $\int_\Omega f \, \dd \mu <\infty$. Then
\[
	\limsup_{n\to \infty} \int_\Omega f_n \dd \mu \le \int_\Omega \limsup_{n\to \infty} f_n \dd \mu.
\]
}
\end{problem}

\begin{problem}\label{pb:DCT-parametric-function}
	Let $(\Omega,\mathcal{F},\mu)$ be a measure space. Assume that $f:\Omega\times(a,b)\to\bbR$ and that $\omega\mapsto f(\omega,t)$ is integrable with respect to $\mu$ for all fixed $t\in(a,b)$. Suppose there exists a non-negative $\mu$-integrable function $g$ such that $|f(\omega,t)|\le g(\omega)$ for all $t\in(a,b)$ and all $\omega\in\Omega$. 
	\begin{enumerate}[label={(\alph*)}]
		\item Fix $t_0\in(a,b)$. Show that if $\lim_{t\to t_0} f(\omega,t)=f(\omega,t_0)$ for all $\omega\in\Omega$, then
		\[
			\lim_{t\to t_0}\int_\Omega f(\omega,t)\,\mu(d\omega) = \int_\Omega f(\omega,t_0)\,\mu(d\omega).
		\]
		\item Deduce from (a) that if $f(\omega,\cdot)$ is continuous for all $\omega$, then the map
		\[
			(a,b)\ni t\mapsto F(t):=\int_\Omega f(\omega,t)\,\mu(d\omega)\quad\text{is continuous.}
		\]
	\end{enumerate}
\end{problem}

\begin{problem}
		Let $(\Omega,\mathcal{F},\mu)$ be a measure space. Assume that $f:\Omega\times(a,b)\to\bbR$ and that $\omega\mapsto f(\omega,t)$ is integrable with respect to $\mu$ for all fixed $t\in(a,b)$. Suppose $\partial f/\partial t$ exists on $(a,b)$ for all $\omega\in \Omega$, i.e.\ for every fixed $\omega\in\Omega$,
		\[
			\frac{\partial f}{\partial t}(\omega, t_0):=\lim_{t\to t_0} \frac{f(\omega,t)-f(\omega,t_0)}{t-t_0} \quad\text{exists for all $t_0\in(a,b)$}.
		\]
		Furthermore, suppose that there is a non-negative $\mu$-integrable function $g$ such that $|\partial f/\partial t|(\omega,t)\le g(\omega)$ for all $t\in(a,b)$ and all $\omega\in\Omega$. Show that the map
		\[
			(a,b)\ni t\mapsto F(t) = \int_\Omega f(\omega,t)\,\mu(d\omega)\quad\text{is differentiable},
		\]
		and the following equality holds:
		\[
			\frac{d}{dt}\int_\Omega f(\omega,t)\,\mu(d\omega) = \int_\Omega \frac{\partial f}{\partial t}(\omega,t)\,\mu(d\omega).
		\]
		
		\smallskip
		
		\noindent\textbf{Hint:} Make the following steps:
		\begin{enumerate}[label={(\arabic*)}]
			\item Show that $(\partial f/\partial t)(\cdot,t)$ is measurable and integrable for all $t\in(a,b)$.
			\item Show that for $t_0\in(a,b)$ arbitrary
			\[
				\left|\frac{f(\omega,t)-f(\omega,t_0)}{t-t_0}\right| \le g(\omega)\quad\text{for any $t\in(a,b)$, $t\ne t_0$ and all $\omega\in\Omega$.}
			\]
			\item Conclude with the help of Problem~\ref{pb:DCT-parametric-function}.
		\end{enumerate}
\end{problem}

\begin{problem}
	Compute the following limits and justify the computation
	\begin{align*}
		& \lim_{n\to\infty} \int_0^1 \frac{1 + n x^2}{(1 + x^2)^n}\,\dd x\,,\qquad\lim_{n\to\infty} \int_{(0,+\infty)} \frac{x^{n-2}}{1+ x^n}\cos\left(\frac{\pi x}{n}\right) \lambda(\dd x) \,.
	\end{align*}
\end{problem}

\begin{problem}[Generalized DCT] Prove the following generalization of DCT:

\textit{
	Let $(\Omega,\mathcal{F},\mu)$ be a measure space. Assume that $f_n$, $g_n$, $f$ and $g$ are $\mu$-integrable functions satisfying
	\begin{enumerate}[label={(\roman*)}]
		\item $f_n\to f$ and $g_n\to g$ $\mu$-almost everywhere,
		\item $|f_n|\le g_n$ for all $n\in\bbN$ and $\int_\Omega g_n\,\dd\mu \to \int_\Omega g\,\dd\mu$ as $n\to \infty$.
	\end{enumerate}
	Then also $\int_\Omega f_n\,\dd\mu \to \int_\Omega f\,\dd\mu$ as $n\to\infty$.	
}
\end{problem}

\begin{problem}\label{prb:portmanteau}
Here we will prove the implication \textbf{1$\iff$3} from Theorem~\ref{thm:portmanteau}. 

\begin{enumerate}[label={(\alph*)}]
\item Prove that \textbf{1} implies \textbf{3}.
\end{enumerate}

The remainder of this problem is dedicate to proving \textbf{3} $\Rightarrow$ \textbf{1}. So we can assume that $\int_\bbR g \, \dd \mu_n \to \int_\bbR g \, \dd \mu$ holds for all continuous bounded functions with compact support.

Now let $f\colon \bbR \to \bbR$ be a continuous bounded function with $|f(x)| \le M$ for all $x \in \bbR$.
\begin{enumerate}[label={(\alph*)}]
\setcounter{enumi}{1}
\item Suppose that for any such $f$ and for any $\varepsilon > 0$ the following holds
\begin{equation}\label{eq:portmanteau_problem_main}
	\left|\int_\bbR f \, \dd \mu_n - \int_\bbR f \, \dd \mu\right| \le \varepsilon.
\end{equation}
Prove the \textbf{1} holds.
\end{enumerate}

It is clear that we have to prove that~\eqref{eq:portmanteau_problem_main} holds for any continuous bounded function $f$. So from now on let $\varepsilon > 0$ be fixed.
\begin{enumerate}[label={(\alph*)}]
\setcounter{enumi}{2}
\item Prove that there exists an $\alpha > 0$ such that $\mu(\bbR \backslash [-\alpha, \alpha]) < \varepsilon/(2M)$.
\item Show that we can define a non-negative continuous function $g$ such that $g = 1$ on $[-\alpha, \alpha]$ and $g = 0$ on $\bbR \backslash (-(\alpha+1),\alpha+1)$.
\end{enumerate}

We now write 
\begin{align*}
	\left|\int_\bbR f \, \dd \mu_n - \int_\bbR f \, \dd \mu\right| &\le \left|\int_\bbR f \, \dd \mu_n - \int_\bbR fg \, \dd \mu_n\right| + \left|\int_\bbR f \, \dd \mu - \int_\bbR fg \, \dd \mu\right|\\ &\hspace{10pt}+ \left|\int_\bbR fg \, \dd \mu_n - \int_\bbR fg \, \dd \mu\right|
\end{align*}

\begin{enumerate}[label={(\alph*)}]
\setcounter{enumi}{4}
\item Show that
\[
	\left|\int_\bbR f \, \dd \mu - \int_\bbR fg \, \dd \mu\right| < \frac{\varepsilon}{2}.
\]
\item Show that
\[
	\limsup_{n \to \infty} \left|\int_\bbR f \, \dd \mu_n - \int_\bbR fg \, \dd \mu_n\right| < \frac{\varepsilon}{2}.
\]
\item Prove that 
\[
	\limsup_{n \to \infty} \left|\int_\bbR fg \, \dd \mu_n - \int_\bbR fg \, \dd \mu\right| = 0.
\]
\item Conclude that~\eqref{eq:portmanteau_problem_main} holds.
\end{enumerate}

%Also observe that we can define a non-negative continuous function $g$ such that $g = 1$ on $[-\alpha, \alpha]$ and $g = 0$ on $\bbR \backslash (-(\alpha+1),\alpha+1)$. Observe that $g$ is a non-negative continuous bounded function that is zero outside the interval $[-(\alpha+1), \alpha+1]$, and thus we can apply (3). We now have that
%\begin{align*}
%	\left|\int_\bbR f \, \dd \mu_n - \int_\bbR fg \, \dd \mu_n\right|
%	&= \left|\int_\bbR f (1-g) \, \dd \mu_n\right| \le M \int_\bbR (1-g) \, \dd \mu_n \\
%	&\le M \int_\bbR (1-g) \, \dd \mu_n = M\left(1-\int_\bbR g \, \dd \mu_n\right)
%\end{align*}
%Since the later term converges to $\int_\bbR g \, \dd \mu$ by our assumption we get that
%\begin{align*}
%	\limsup_{n \to \infty} \left|\int_\bbR f \, \dd \mu_n - \int_\bbR fg \, \dd \mu_n\right|
%	&\le M \int_\bbR (1-g) \, \dd \mu \le M \mu(\bbR \backslash [-\alpha,\alpha]) < \frac{\varepsilon}{2}.
%\end{align*}
%The same conclusion holds true for $\left|\int_\bbR f \, \dd \mu - \int_\bbR fg \, \dd \mu\right|$.
%
%If we now write
%\begin{align*}
%	\left|\int_\bbR f \, \dd \mu_n - \int_\bbR f \, \dd \mu\right| &\le \left|\int_\bbR f \, \dd \mu_n - \int_\bbR fg \, \dd \mu_n\right| + \left|\int_\bbR f \, \dd \mu - \int_\bbR fg \, \dd \mu\right|\\ &\hspace{10pt}+ \left|\int_\bbR fg \, \dd \mu_n - \int_\bbR fg \, \dd \mu\right|
%\end{align*}
%we see that the first two terms converge to $\varepsilon/2$ (by the computation above) while the term on the second line converges to zero by our assumption since $fg$ is also a continuous bounded function that is zero outside the interval $[-(\alpha+1),\alpha+1]$. 
\end{problem}

